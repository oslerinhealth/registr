<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Binary functional principal components analysis — bfpca • registr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Binary functional principal components analysis — bfpca" />
<meta property="og:description" content="Function used in the FPCA step for registering binary functional data,
called by register_fpca when family = &quot;binomial&quot;. 
This method uses a variational EM algorithm to estimate scores and principal components for 
binary functional data.  
The number of functional principal components (FPCs) can either be specified
directly (argument npc) or chosen based on the explained share of
variance (npc_varExplained). For the latter, the solution is based
on running the FPCA with npc = 20 (and correspondingly Kt = 20)
before reducing the solution to the relevant number of FPCs. Doing so,
we approximate the overall variance in the data Y with the variance
represented by the FPC basis with 20 FPCs." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">registr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/registr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/incomplete_curves.html">Registering Incomplete Curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Binary functional principal components analysis</h1>
    
    <div class="hidden name"><code>bfpca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function used in the FPCA step for registering binary functional data,
called by <code><a href='register_fpca.html'>register_fpca</a></code> when <code>family = "binomial"</code>. 
This method uses a variational EM algorithm to estimate scores and principal components for 
binary functional data. <br /> <br />
The number of functional principal components (FPCs) can either be specified
directly (argument <code>npc</code>) or chosen based on the explained share of
variance (<code>npc_varExplained</code>). For the latter, the solution is based
on running the FPCA with <code>npc = 20</code> (and correspondingly <code>Kt = 20</code>)
before reducing the solution to the relevant number of FPCs. Doing so,
we approximate the overall variance in the data <code>Y</code> with the variance
represented by the FPC basis with 20 FPCs.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>bfpca</span><span class='op'>(</span>
  <span class='va'>Y</span>,
  npc <span class='op'>=</span> <span class='cn'>NULL</span>,
  npc_varExplained <span class='op'>=</span> <span class='cn'>NULL</span>,
  Kt <span class='op'>=</span> <span class='fl'>8</span>,
  maxiter <span class='op'>=</span> <span class='fl'>50</span>,
  t_min <span class='op'>=</span> <span class='cn'>NULL</span>,
  t_max <span class='op'>=</span> <span class='cn'>NULL</span>,
  print.iter <span class='op'>=</span> <span class='cn'>FALSE</span>,
  row_obj <span class='op'>=</span> <span class='cn'>NULL</span>,
  seed <span class='op'>=</span> <span class='fl'>1988</span>,
  periodic <span class='op'>=</span> <span class='cn'>FALSE</span>,
  error_thresh <span class='op'>=</span> <span class='fl'>1e-04</span>,
  verbose <span class='op'>=</span> <span class='fl'>1</span>,
  subsample <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Y</th>
      <td><p>Dataframe. Should have variables id, value, index.</p></td>
    </tr>
    <tr>
      <th>npc</th>
      <td><p>The number of functional principal components (FPCs)
has to be specified either directly as <code>npc</code> or based on their explained
share of variance. In the latter case, <code>npc_varExplained</code> has to be set
to a share between 0 and 1.</p></td>
    </tr>
    <tr>
      <th>npc_varExplained</th>
      <td><p>The number of functional principal components (FPCs)
has to be specified either directly as <code>npc</code> or based on their explained
share of variance. In the latter case, <code>npc_varExplained</code> has to be set
to a share between 0 and 1.</p></td>
    </tr>
    <tr>
      <th>Kt</th>
      <td><p>Number of B-spline basis functions used to estimate mean functions
and functional principal components. Default is 8. If <code>npc_varExplained</code>
is used, <code>Kt</code> is set to 20.</p></td>
    </tr>
    <tr>
      <th>maxiter</th>
      <td><p>Maximum number of iterations to perform for EM algorithm. Default is 50.</p></td>
    </tr>
    <tr>
      <th>t_min</th>
      <td><p>Minimum value to be evaluated on the time domain.</p></td>
    </tr>
    <tr>
      <th>t_max</th>
      <td><p>Maximum value to be evaluated on the time domain.</p></td>
    </tr>
    <tr>
      <th>print.iter</th>
      <td><p>Prints current error and iteration</p></td>
    </tr>
    <tr>
      <th>row_obj</th>
      <td><p>If NULL, the function cleans the data and calculates row indices. 
Keep this NULL if you are using standalone <code>register</code> function.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Set seed for reproducibility. Defaults to 1988.</p></td>
    </tr>
    <tr>
      <th>periodic</th>
      <td><p>If TRUE, uses periodic b-spline basis functions. Default is FALSE.</p></td>
    </tr>
    <tr>
      <th>error_thresh</th>
      <td><p>Error threshold to end iterations. Defaults to 0.0001.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Can be set to integers between 0 and 4 to control the level of
detail of the printed diagnostic messages. Higher numbers lead to more detailed
messages. Defaults to 1.</p></td>
    </tr>
    <tr>
      <th>subsample</th>
      <td><p>if the number of rows of the data is greater than 
10 million rows, the `id` values are subsampled to get the mean coefficients.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to or from other functions</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>fpca</code> containing:</p>
<dt>fpca_type</dt><dd><p>Information that FPCA was performed with the 'variationEM' approach,
in contrast to registr::gfpca_twoStep.</p></dd>
<dt>t_vec</dt><dd><p>Time vector over which the mean <code>mu</code> and the functional principal
components <code>efunctions</code> were evaluated.</p></dd>
<dt>knots</dt><dd><p>Cutpoints for B-spline basis used to rebuild <code>alpha</code>.</p></dd>
<dt>efunctions</dt><dd><p>\(D \times npc\) matrix of estimated FPC basis functions.</p></dd>
<dt>evalues</dt><dd><p>Estimated variance of the FPC scores.</p></dd>
<dt>evalues_sum</dt><dd><p>Approximation of the overall variance in <code>Y</code>, based
on an initial run of the FPCA with <code>npc = 20</code>. Is <code>NULL</code> if
<code>npc_varExplained</code> was not specified.</p></dd>
<dt>npc</dt><dd><p>number of FPCs.</p></dd>
<dt>scores</dt><dd><p>\(I \times npc\) matrix of estimated FPC scores.</p></dd>
<dt>alpha</dt><dd><p>Estimated population-level mean.</p></dd>
<dt>mu</dt><dd><p>Estimated population-level mean. Same value as <code>alpha</code> but included for compatibility
with <code>refund.shiny</code> package.</p></dd>
<dt>subject_coefs</dt><dd><p>B-spline basis coefficients used to construct subject-specific means. 
For use in <code><a href='registr.html'>registr()</a></code> function.</p></dd>
<dt>Yhat</dt><dd><p>FPC approximation of subject-specific means, before applying the
response function.</p></dd>
<dt>Y</dt><dd><p>The observed data.</p></dd>
<dt>family</dt><dd><p><code>binomial</code>, for compatibility with <code>refund.shiny</code> package.</p></dd>
<dt>error</dt><dd><p>vector containing error for each iteration of the algorithm.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jaakkola, T. S. and Jordan, M. I. (1997).
A variational approach to Bayesian logistic regression models and their extensions. 
<em>Proceedings of the Sixth International Workshop on Artificial Intelligence 
and Statistics</em>.</p>
<p>Tipping, M. E. (1999). Probabilistic Visualisation of High-dimensional binary data.
<em>Advances in neural information processing systems</em>, 592--598.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Julia Wrobel <a href='mailto:julia.wrobel@cuanschutz.edu'>julia.wrobel@cuanschutz.edu</a>,
Jeff Goldsmith <a href='mailto:ajg2202@cumc.columbia.edu'>ajg2202@cumc.columbia.edu</a>,
Alexander Bauer <a href='mailto:alexander.bauer@stat.uni-muenchen.de'>alexander.bauer@stat.uni-muenchen.de</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='va'>Y</span> <span class='op'>=</span> <span class='fu'><a href='simulate_functional_data.html'>simulate_functional_data</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>$</span><span class='va'>Y</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># estimate 2 FPCs</span></span>
<span class='r-in'><span class='va'>bfpca_obj</span> <span class='op'>=</span> <span class='fu'>bfpca</span><span class='op'>(</span><span class='va'>Y</span>, npc <span class='op'>=</span> <span class='fl'>2</span>, print.iter <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 1</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 100</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 2</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 5.23757448496724</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 3</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 2.10423045823871</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 4</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.361578852642602</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 5</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.147695757754779</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 6</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0830027428194467</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 7</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0540252930253222</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 8</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0382233942429727</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 9</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0285053744310382</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 10</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0220318973196186</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 11</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0174689087814425</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 12</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0141154309484551</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 13</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.011571424789507</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 14</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0095934412787888</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 15</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00802543182956816</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 16</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0067629837973291</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 17</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00573367553537881</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 18</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00488572496523099</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 19</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0041811399738437</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 20</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00359142647616603</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 21</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00309480833663458</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 22</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00267437277435423</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 23</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00231680026393003</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 24</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00201147408756619</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 25</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00174984282235493</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 26</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00152495526325296</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 27</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00133111538478376</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 28</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00116362246843998</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 29</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00101857270633032</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 30</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000892705883236266</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 31</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00078328558855105</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 32</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000688004694465824</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 33</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000604910100186184</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 34</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000532342326496986</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 35</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000468886670614061</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 36</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000413333441896506</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 37</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000364645390181679</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 38</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000321930874738516</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 39</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000284421647255292</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 40</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000251454367495633</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 41</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000222455156777906</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 42</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000196926637547958</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 43</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000174437018053203</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 44</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000154610867424436</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 45</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000137121294234351</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 46</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000121683295163882</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 47</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000108048082998942</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bfpca_obj</span><span class='op'>)</span></span>
<span class='r-plt'><img src='bfpca-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># estimate npc adaptively, to explain 90% of the overall variation</span></span>
<span class='r-in'><span class='va'>bfpca_obj2</span> <span class='op'>=</span> <span class='fu'>bfpca</span><span class='op'>(</span><span class='va'>Y</span>, npc_varExplained <span class='op'>=</span> <span class='fl'>0.9</span>, print.iter <span class='op'>=</span> <span class='cn'>TRUE</span>, maxiter <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 1</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 100</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 2</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 36.7303654336817</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 3</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 3.57019489158518</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 4</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.909202833535933</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 5</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.336009214516865</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 6</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.1589471594984</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 7</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0899122028370048</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 8</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0572856279453935</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 9</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.039473867744754</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 10</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.028710986504062</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 11</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0217168583720954</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 12</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0169188041754984</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 13</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0134866053910595</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 14</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0109482177061547</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 15</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00901910428351263</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 16</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00751952603002818</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 17</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00633149816216042</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 18</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00537503674993192</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 19</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00459439901770998</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 20</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00394978426453036</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 21</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00341215530865912</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 22</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00295991213528492</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 23</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00257670104546436</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 24</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00224993954360199</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 25</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00196980339553141</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 26</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00172851851769075</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 27</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00151985775208477</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 28</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00133877771584143</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 29</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.0011811529198107</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 30</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00104357841538443</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 31</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000923221381335063</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 32</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000817708115367042</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 33</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000725036956787569</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 34</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000643510428806464</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 35</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000571681790576205</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 36</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000508312513397854</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 37</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000452338127925485</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 38</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000402840552515751</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 39</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000359025489533277</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 40</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000320203822277416</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 41</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000285776198559983</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 42</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000255220174284476</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 43</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000228079430154776</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 44</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000203954679866915</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 45</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.00018249596806538</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 46</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000163396117577855</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 47</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000146385132748259</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 48</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000131225402541964</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 49</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000117707576040492</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current iteration: 50</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> current error: 0.000105647005836009</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Using the first 2 FPCs which explain 94.7% of the (approximated) total variance.</span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bfpca_obj2</span><span class='op'>)</span></span>
<span class='r-plt'><img src='bfpca-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Julia Wrobel, Alexander Bauer, Jeff Goldsmith, Erin McDonnell.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


