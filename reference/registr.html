<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Register Exponential Family Functional Data — registr • registr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Register Exponential Family Functional Data — registr" />
<meta property="og:description" content="Software for registering functional data from the exponential family of distributions.
Function used in the registration step of an FPCA-based approach for 
registering exponential-family, potentially incomplete functional data,
called by register_fpca. 
This method uses constrained optimization to estimate spline 
coefficients for warping functions, where the objective function for optimization comes from 
maximizing the EF likelihood subject to monotonicity constraints on the warping functions. 
You have to either specify obj, which is a fpca 
object from an earlier step, or Y, a dataframe in long format with variables 
id, index, and value to indicate subject IDs, times, and observations, 
respectively.  
Warping functions by default are forced to start and end on the diagonal to be
domain-preserving. This behavior can be changed by setting
incompleteness to some other value than NULL and a reasonable lambda_inc value.
For further details see the accompanying vignette.  
By specifying cores &amp;gt; 1 the registration call can be parallelized." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">registr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/registr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/incomplete_curves.html">Registering Incomplete Curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Register Exponential Family Functional Data</h1>
    
    <div class="hidden name"><code>registr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Software for registering functional data from the exponential family of distributions.</p>
<p>Function used in the registration step of an FPCA-based approach for 
registering exponential-family, potentially incomplete functional data,
called by <code><a href='register_fpca.html'>register_fpca</a></code>. 
This method uses constrained optimization to estimate spline 
coefficients for warping functions, where the objective function for optimization comes from 
maximizing the EF likelihood subject to monotonicity constraints on the warping functions. 
You have to either specify <code>obj</code>, which is a fpca 
object from an earlier step, or <code>Y</code>, a dataframe in long format with variables 
<code>id</code>, <code>index</code>, and <code>value</code> to indicate subject IDs, times, and observations, 
respectively. <br /> <br />
Warping functions by default are forced to start and end on the diagonal to be
domain-preserving. This behavior can be changed by setting
<code>incompleteness</code> to some other value than NULL and a reasonable <code>lambda_inc</code> value.
For further details see the accompanying vignette. <br /> <br />
By specifying <code>cores &gt; 1</code> the registration call can be parallelized.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>registr</span><span class='op'>(</span>
  obj <span class='op'>=</span> <span class='cn'>NULL</span>,
  Y <span class='op'>=</span> <span class='cn'>NULL</span>,
  Kt <span class='op'>=</span> <span class='fl'>8</span>,
  Kh <span class='op'>=</span> <span class='fl'>4</span>,
  family <span class='op'>=</span> <span class='st'>"gaussian"</span>,
  gradient <span class='op'>=</span> <span class='cn'>TRUE</span>,
  incompleteness <span class='op'>=</span> <span class='cn'>NULL</span>,
  lambda_inc <span class='op'>=</span> <span class='cn'>NULL</span>,
  Y_template <span class='op'>=</span> <span class='cn'>NULL</span>,
  beta <span class='op'>=</span> <span class='cn'>NULL</span>,
  t_min <span class='op'>=</span> <span class='cn'>NULL</span>,
  t_max <span class='op'>=</span> <span class='cn'>NULL</span>,
  row_obj <span class='op'>=</span> <span class='cn'>NULL</span>,
  periodic <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warping <span class='op'>=</span> <span class='st'>"nonparametric"</span>,
  gamma_scales <span class='op'>=</span> <span class='cn'>NULL</span>,
  cores <span class='op'>=</span> <span class='fl'>1L</span>,
  subsample <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>...</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>Current estimate of FPC object. 
Can be NULL only if Y argument is selected.</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>Dataframe. Should have values id, value, index.</p></td>
    </tr>
    <tr>
      <th>Kt</th>
      <td><p>Number of B-spline basis functions used to estimate mean functions. Default is 8.</p></td>
    </tr>
    <tr>
      <th>Kh</th>
      <td><p>Number of B-spline basis functions used to estimate warping functions <em>h</em>. Default is 4.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>One of <code>c("gaussian","binomial","gamma","poisson")</code>. Defaults to
<code>"gaussian"</code>.</p></td>
    </tr>
    <tr>
      <th>gradient</th>
      <td><p>If <code>TRUE</code>, uses analytic gradient to calculate derivative. 
If <code>FALSE</code>, calculates gradient numerically. Not available for families
<code>"gamma","poisson"</code>.</p></td>
    </tr>
    <tr>
      <th>incompleteness</th>
      <td><p>Optional specification of incompleteness structure.
One of <code>c("leading","trailing","full")</code>, specifying that incompleteness
is present only in the initial measurements, only in the trailing measurements, or
in both, respectively. For details see the accompanying vignette.
Defaults to NULL, i.e. no incompleteness structure.
Can only be set when <code>warping = "nonparametric"</code>.</p></td>
    </tr>
    <tr>
      <th>lambda_inc</th>
      <td><p>Penalization parameter to control the amount of
overall dilation of the domain.
The higher this lambda, the more the registered domains are forced to have the
same length as the observed domains.
Only used if <code>incompleteness</code> is not NULL.</p></td>
    </tr>
    <tr>
      <th>Y_template</th>
      <td><p>Optional dataframe with the same structure as <code>Y</code>.
Only used if <code>obj</code> is NULL. If <code>Y_template</code> is NULL,
curves are registered to the overall mean of all curves in <code>Y</code> as template function.
If <code>Y_template</code> is specified, the template function is taken as the mean
of all curves in <code>Y_template</code>. Default is NULL.</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>Current estimates for beta for each subject. Default is NULL.</p></td>
    </tr>
    <tr>
      <th>t_min</th>
      <td><p>Minimum value to be evaluated on the time domain.
if `NULL`, taken to be minimum observed value.</p></td>
    </tr>
    <tr>
      <th>t_max</th>
      <td><p>Maximum value to be evaluated on the time domain. 
if `NULL`, taken to be maximum observed value.</p></td>
    </tr>
    <tr>
      <th>row_obj</th>
      <td><p>If NULL, the function cleans the data and calculates row indices. 
Keep this NULL if you are using standalone <code>registr</code> function.</p></td>
    </tr>
    <tr>
      <th>periodic</th>
      <td><p>If <code>TRUE</code>, uses periodic b-spline basis functions. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>warping</th>
      <td><p>If <code>nonparametric</code> (default), inverse warping functions are estimated nonparametrically. 
If <code>piecewise_linear2</code> they follow a piecewise linear function with 2 knots.</p></td>
    </tr>
    <tr>
      <th>gamma_scales</th>
      <td><p>Only used for <code>family = "gamma"</code>.
Vector with one entry for each subject, containing the current estimate for the scale parameter of its
gamma distribution. Default is NULL, which sets the starting value for the scale parameter to 1.5.</p></td>
    </tr>
    <tr>
      <th>cores</th>
      <td><p>Number of cores to be used. If <code>cores &gt; 1</code>, the registration
call is parallelized by using <code><a href='https://rdrr.io/r/parallel/mclapply.html'>parallel::mclapply</a></code> (for Unix-based
systems) or <code><a href='https://rdrr.io/r/parallel/clusterApply.html'>parallel::parLapply</a></code> (for Windows). Defaults to 1,
no parallelized call.</p></td>
    </tr>
    <tr>
      <th>subsample</th>
      <td><p>if the number of rows of the data is greater than 
10 million rows, the `id` values are subsampled to get the mean coefficients.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Can be set to integers between 0 and 4 to control the level of
detail of the printed diagnostic messages. Higher numbers lead to more detailed
messages. Defaults to 1.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to or from other functions</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An list containing:</p>
<dt>Y</dt><dd><p>The observed data. The variables <code>index</code> and <code>index_scaled</code>
contain the new estimated time domain.</p></dd>
<dt>loss</dt><dd><p>Value of the loss function after registraton.</p></dd>
<dt>hinv_innerKnots</dt><dd><p>List of inner knots for setting up the spline bases
for the inverse warping functions. Only contains <code>NULL</code> values for
<code>Kh &lt;= 4</code>.</p></dd>
<dt>hinv_beta</dt><dd><p>Matrix of B-spline basis coefficients used to construct
subject-specific inverse warping functions. See examples on how to
reconstruct a warping function based on <code>hinv_innerKnots</code> and
<code>hinv_beta</code>.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The template function for the registration is defined by argument <code>obj</code>
or <code>Y_template</code>, depending on if <code>obj</code> is NULL or not, respectively.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Julia Wrobel</p>
<p>Julia Wrobel <a href='mailto:julia.wrobel@cuanschutz.edu'>julia.wrobel@cuanschutz.edu</a>,
Erin McDonnell <a href='mailto:eim2117@cumc.columbia.edu'>eim2117@cumc.columbia.edu</a>,
Alexander Bauer <a href='mailto:alexander.bauer@stat.uni-muenchen.de'>alexander.bauer@stat.uni-muenchen.de</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='co'>### complete binomial curves</span></span>
<span class='r-in'><span class='va'>Y</span> <span class='op'>=</span> <span class='fu'><a href='simulate_unregistered_curves.html'>simulate_unregistered_curves</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>register_step</span> <span class='op'>=</span> <span class='fu'>registr</span><span class='op'>(</span>obj <span class='op'>=</span> <span class='cn'>NULL</span>, Y <span class='op'>=</span> <span class='va'>Y</span>, Kt <span class='op'>=</span> <span class='fl'>6</span>, Kh <span class='op'>=</span> <span class='fl'>4</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span>, </span>
<span class='r-in'>                        gradient <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># \donttest{</span></span>
<span class='r-in'><span class='co'>### incomplete Gaussian curves</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>growth_incomplete</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Force the warping functions to start and end on the diagonal to preserve the domain</span></span>
<span class='r-in'><span class='va'>register_step2a</span> <span class='op'>=</span> <span class='fu'>registr</span><span class='op'>(</span>obj <span class='op'>=</span> <span class='cn'>NULL</span>, Y <span class='op'>=</span> <span class='va'>growth_incomplete</span>, Kt <span class='op'>=</span> <span class='fl'>6</span>, Kh <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span class='r-in'>                          family <span class='op'>=</span> <span class='st'>"gaussian"</span>, gradient <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span class='r-in'>                          incompleteness <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"ggplot2"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>register_step2a</span><span class='op'>$</span><span class='va'>Y</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>tstar</span>, y <span class='op'>=</span> <span class='va'>index</span>, group <span class='op'>=</span> <span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Estimated warping functions"</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>register_step2a</span><span class='op'>$</span><span class='va'>Y</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>index</span>, y <span class='op'>=</span> <span class='va'>value</span>, group <span class='op'>=</span> <span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Registered curves"</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-plt'><img src='registr-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'>  </span>
<span class='r-in'><span class='co'># Example for how to recreate an estimated inverse warping function given</span></span>
<span class='r-in'><span class='co'># the output of registr(). Focus on id "boy01".</span></span>
<span class='r-in'><span class='va'>id</span>         <span class='op'>=</span> <span class='st'>"boy01"</span></span>
<span class='r-in'><span class='va'>index_obsRange_i</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span><span class='op'>(</span><span class='va'>growth_incomplete</span><span class='op'>$</span><span class='va'>index</span><span class='op'>[</span><span class='va'>growth_incomplete</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>==</span> <span class='va'>id</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>index</span>      <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>index_obsRange_i</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>index_obsRange_i</span><span class='op'>)</span>, length.out <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># (note that 'index' must contain both the observed min and max in index_obsRange_i)</span></span>
<span class='r-in'><span class='va'>Theta_h_i</span>  <span class='op'>=</span> <span class='fu'>splines</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/splines/bs.html'>bs</a></span><span class='op'>(</span><span class='va'>index</span>, knots <span class='op'>=</span> <span class='va'>register_step2a</span><span class='op'>$</span><span class='va'>hinv_innerKnots</span><span class='op'>[[</span><span class='va'>id</span><span class='op'>]</span><span class='op'>]</span>, intercept <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>index_reg</span>  <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>as.vector</a></span><span class='op'>(</span><span class='va'>Theta_h_i</span> <span class='op'><a href='https://rdrr.io/r/base/matmult.html'>%*%</a></span> <span class='va'>register_step2a</span><span class='op'>$</span><span class='va'>hinv_beta</span><span class='op'>[</span>,<span class='va'>id</span><span class='op'>]</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>warp_dat_i</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>index_observed   <span class='op'>=</span> <span class='va'>index</span>,</span>
<span class='r-in'>                        index_registered <span class='op'>=</span> <span class='va'>index_reg</span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"ggplot2"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>warp_dat_i</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>index_observed</span>, y <span class='op'>=</span> <span class='va'>index_registered</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Extracted warping function for id 'boy01'"</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-plt'><img src='registr-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Allow the warping functions to not start / end on the diagonal.</span></span>
<span class='r-in'><span class='co'># The higher lambda_inc, the more the starting points and endpoints are</span></span>
<span class='r-in'><span class='co'># forced towards the diagonal.</span></span>
<span class='r-in'><span class='va'>register_step2b</span> <span class='op'>=</span> <span class='fu'>registr</span><span class='op'>(</span>obj <span class='op'>=</span> <span class='cn'>NULL</span>, Y <span class='op'>=</span> <span class='va'>growth_incomplete</span>, Kt <span class='op'>=</span> <span class='fl'>6</span>, Kh <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span class='r-in'>                          family <span class='op'>=</span> <span class='st'>"gaussian"</span>, gradient <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span class='r-in'>                          incompleteness <span class='op'>=</span> <span class='st'>"full"</span>, lambda_inc <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"ggplot2"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>register_step2b</span><span class='op'>$</span><span class='va'>Y</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>tstar</span>, y <span class='op'>=</span> <span class='va'>index</span>, group <span class='op'>=</span> <span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Estimated warping functions"</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>register_step2b</span><span class='op'>$</span><span class='va'>Y</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>index</span>, y <span class='op'>=</span> <span class='va'>value</span>, group <span class='op'>=</span> <span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Registered curves"</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-plt'><img src='registr-3.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># Define the template function only over a subset of the curves</span></span>
<span class='r-in'><span class='co'># (even though not very reasonable in this example)</span></span>
<span class='r-in'><span class='va'>template_ids</span>    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"girl12"</span>,<span class='st'>"girl13"</span>,<span class='st'>"girl14"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>Y_template</span>      <span class='op'>=</span> <span class='va'>growth_incomplete</span><span class='op'>[</span><span class='va'>growth_incomplete</span><span class='op'>$</span><span class='va'>id</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>template_ids</span>,<span class='op'>]</span></span>
<span class='r-in'><span class='va'>register_step2c</span> <span class='op'>=</span> <span class='fu'>registr</span><span class='op'>(</span>obj <span class='op'>=</span> <span class='cn'>NULL</span>, Y <span class='op'>=</span> <span class='va'>growth_incomplete</span>, Kt <span class='op'>=</span> <span class='fl'>6</span>, Kh <span class='op'>=</span> <span class='fl'>4</span>,</span>
<span class='r-in'>                          family <span class='op'>=</span> <span class='st'>"gaussian"</span>, gradient <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span class='r-in'>                          Y_template <span class='op'>=</span> <span class='va'>Y_template</span>,</span>
<span class='r-in'>                          incompleteness <span class='op'>=</span> <span class='st'>"full"</span>, lambda_inc <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"ggplot2"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>register_step2c</span><span class='op'>$</span><span class='va'>Y</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>index</span>, y <span class='op'>=</span> <span class='va'>value</span>, group <span class='op'>=</span> <span class='va'>id</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Registered curves"</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-plt'><img src='registr-4.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># }</span></span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Julia Wrobel, Alexander Bauer, Jeff Goldsmith, Erin McDonnell.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


