<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Curve Registration for Exponential Family Functional Data • registr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Curve Registration for Exponential Family Functional Data">
<meta property="og:description" content="A method for performing joint registration and functional
        principal component analysis for curves (functional data) that
        are generated from exponential family distributions. This
        mainly implements the algorithms described in Wrobel et al.
        (2019) &lt;doi:10.1111/biom.12963&gt; and further adapts them to
        potentially incomplete curves where (some) curves are not
        observed from the beginning and/or until the end of the common
        domain. Curve registration can be used to better understand
        patterns in functional data by separating curves into phase and
        amplitude variability. This software handles both binary and
        continuous functional data, and is especially applicable in
        accelerometry and wearable technology.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">registr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/registr.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/incomplete_curves.html">Registering Incomplete Curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="registr-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#registr-" class="anchor" aria-hidden="true"></a>registr <img src="README_files/figures/registr.png" align="right" height="150">
</h1></div>
<!-- badges: start -->

<p>Registration for incomplete exponential family functional data.</p>
<ul>
<li>Authors: <a href="http://juliawrobel.com" class="external-link">Julia Wrobel</a>, <a href="https://www.en.stablab.stat.uni-muenchen.de/people/doktoranden/bauer1/index.html" class="external-link">Alexander Bauer</a>
</li>
<li>License: <a href="https://opensource.org/licenses/MIT" class="external-link">MIT</a>. See the <a href="LICENSE">LICENSE</a> file for details</li>
<li>Version: 2.1</li>
</ul>
<div id="what-it-does" class="section level3">
<h3 class="hasAnchor">
<a href="#what-it-does" class="anchor" aria-hidden="true"></a>What it does</h3>
<hr>
<p>Functional data analysis is a set of tools for understanding patterns and variability in data where the basic unit of observation is a curve measured over some domain such as time or space. An example is an accelerometer study where intensity of physical activity was measured at each minute over 24 hours for 50 subjects. The data will contain 50 curves, where each curve is the 24-hour activity profile for a particular subject.</p>
<p>Classic functional data analysis assumes that each curve is continuous or comes from a Gaussian distribution. However, applications with exponential family functional data – curves that arise from any exponential family distribution, and have a smooth latent mean – are increasingly common. For example, take the accelerometer data just mentioned, but assume researchers are interested in <em>sedentary behavior</em> instead of <em>activity intensity</em>. At each minute over 24 hours they collect a binary measurement that indicates whether a subject was active or inactive (sedentary). Now we have a <em>binary curve</em> for each subject – a trajectory where each time point can take on a value of 0 or 1. We assume the binary curve has a smooth latent mean, which in this case is interpreted as the probability of being active at each minute over 24 hours. This is a example of exponential family functional data.</p>
<p>Often in a functional dataset curves have similar underlying patterns but the main features of each curve, such as the minimum and maximum, have shifts such that the data appear misaligned. This misalignment can obscure patterns shared across curves and produce messy summary statistics. Registration methods reduce variability in functional data and clarify underlying patterns by aligning curves.</p>
<p>This package implements statistical methods for registering exponential family functional data. The basic methods are described in more detail in our <a href="http://juliawrobel.com/Downloads/registration_ef.pdf" class="external-link">paper</a> and were further adapted to (potentially) incomplete curve settings where (some) curves are not observed from the very beginning and/or until the very end of the common domain. For details on the incomplete curve methodology and how to use it see the corresponding package vignette. Instructions for installing the software and using it to register simulated binary data are provided below.</p>
</div>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor" aria-hidden="true"></a>Installation</h3>
<hr>
<p>To install from <code>CRAN</code>, please use:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"registr"</span><span class="op">)</span></code></pre></div>
<p>To install the latest version directly from Github, please use:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"julia-wrobel/registr"</span><span class="op">)</span></code></pre></div>
<p>The <code>registr</code> package includes vignettes with more details on package use and functionality. To install the latest version and pull up the vignettes please use:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"julia-wrobel/registr"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/vignette.html" class="external-link">vignette</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"registr"</span><span class="op">)</span></code></pre></div>
</div>
<div id="how-to-use-it" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-use-it" class="anchor" aria-hidden="true"></a>How to use it</h3>
<hr>
<p>This example registers simulated binary data. More details on the use of the package can be found in the vignettes mentioned above.</p>
<p>The code below uses <code><a href="reference/simulate_unregistered_curves.html">registr::simulate_unregistered_curves()</a></code> to simulate curves for 100 subjects with 200 timepoints each, observed over domain (0, 1). All curves have similar structure but the location of the peak is shifted. On the observed domain <em>t</em><sup>*</sup> the curves are unregistered (misaligned). On the domain <em>t</em> the curves are registered (aligned).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">registr</span><span class="op">)</span>

<span class="va">registration_data</span> <span class="op">=</span> <span class="fu"><a href="reference/simulate_unregistered_curves.html">simulate_unregistered_curves</a></span><span class="op">(</span>I <span class="op">=</span> <span class="fl">100</span>, D <span class="op">=</span> <span class="fl">200</span>, seed <span class="op">=</span> <span class="fl">2018</span><span class="op">)</span></code></pre></div>
<p>The plot below shows the unregistered curves and registered curves.</p>
<p><img src="README_files/figure-gfm/plot_sim_data-1.png" style="display: block; margin: auto;"></p>
<p>Continuously observed curves are shown above in order to illustrate the misalignment problem and our simulated data; the simulated dataset also includes binary values which have been generated by using these continuous curves as probabilities. The unregistered and registered binary curves for two subjects are shown below.</p>
<p><img src="README_files/figure-gfm/plot_2subjs-1.png" style="display: block; margin: auto;"></p>
<p>Our software registers curves by estimating <em>t</em>. For this we use the function <code>registration_fpca()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">binary_registration</span> <span class="op">=</span> <span class="fu"><a href="reference/register_fpca.html">register_fpca</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">registration_data</span>, family <span class="op">=</span> <span class="st">"binomial"</span>, 
                                    Kt <span class="op">=</span> <span class="fl">6</span>, Kh <span class="op">=</span> <span class="fl">4</span>, npc  <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">## Running initial registration step</span>
<span class="co">## current iteration: 1</span>
<span class="co">## Running final FPCA step</span></code></pre></div>
<p>The plot below shows unregistered, true registered, and estimated registered binary curves for two subjects after fitting our method.</p>
<p><img src="README_files/figure-gfm/plot_fit-1.png" style="display: block; margin: auto;"></p>
</div>
<div id="citation" class="section level3">
<h3 class="hasAnchor">
<a href="#citation" class="anchor" aria-hidden="true"></a>Citation</h3>
<p>If you like our software, please cite it in your work! To cite the latest <code>CRAN</code> version of the package with <code>BibTeX</code>, use</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="op">@</span>Manual{,</span>
<span id="cb6-2"><a href="#cb6-2"></a>    title =<span class="st"> </span>{registr<span class="op">:</span><span class="st"> </span>Registration <span class="cf">for</span> Exponential Family Functional Data},</span>
<span id="cb6-3"><a href="#cb6-3"></a>    author =<span class="st"> </span>{Julia Wrobel and Erin McDonnell and Jeff Goldsmith},</span>
<span id="cb6-4"><a href="#cb6-4"></a>    year =<span class="st"> </span>{<span class="dv">2020</span>},</span>
<span id="cb6-5"><a href="#cb6-5"></a>    note =<span class="st"> </span>{R package version <span class="dv">1</span>.<span class="fl">0.0</span>},</span>
<span id="cb6-6"><a href="#cb6-6"></a>    url =<span class="st"> </span>{https<span class="op">:</span><span class="er">//</span>CRAN.R<span class="op">-</span>project.org<span class="op">/</span>package=registr},</span>
<span id="cb6-7"><a href="#cb6-7"></a>  }</span></code></pre></div>
<p>To cite the Journal of Open Source Software paper, use</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="op">@</span>article{wrobel2018regis,</span>
<span id="cb7-2"><a href="#cb7-2"></a>  title={registr<span class="op">:</span><span class="st"> </span>Registration <span class="cf">for</span> Exponential Family Functional Data},</span>
<span id="cb7-3"><a href="#cb7-3"></a>  author={Wrobel, Julia},</span>
<span id="cb7-4"><a href="#cb7-4"></a>  journal={The Journal of Open Source Software},</span>
<span id="cb7-5"><a href="#cb7-5"></a>  volume={<span class="dv">3</span>},</span>
<span id="cb7-6"><a href="#cb7-6"></a>  year={<span class="dv">2018</span>}</span>
<span id="cb7-7"><a href="#cb7-7"></a>}</span></code></pre></div>
</div>
<div id="contributions" class="section level3">
<h3 class="hasAnchor">
<a href="#contributions" class="anchor" aria-hidden="true"></a>Contributions</h3>
<hr>
<p>If you find small bugs, larger issues, or have suggestions, please file them using the <a href="https://github.com/julia-wrobel/registr/issues" class="external-link">issue tracker</a> or email the maintainer at <a href="mailto:julia.wrobel@cuanschutz.edu" class="email">julia.wrobel@cuanschutz.edu</a>. Contributions (via pull requests or otherwise) are welcome.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=registr">https://​cloud.r-project.org/​package=registr</a>
</li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Julia Wrobel <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-6783-1421" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Alexander Bauer <br><small class="roles"> Author </small>  </li>
<li>Jeff Goldsmith <br><small class="roles"> Author </small>  </li>
<li>Erin McDonnell <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More on authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=registr" class="external-link"><img src="https://www.r-pkg.org/badges/version/registr"></a></li>
<li><a href="https://cran.r-project.org/package=registr" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/registr?color=green"></a></li>
<li><a href="https://travis-ci.org/julia-wrobel/registr" class="external-link"><img src="https://travis-ci.org/julia-wrobel/registr.svg?branch=master"></a></li>
<li><a href="https://ci.appveyor.com/project/julia-wrobel/registr" class="external-link"><img src="https://ci.appveyor.com/api/projects/status/github/julia-wrobel/registr?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
<li><a href="https://codecov.io/gh/julia-wrobel/registr/coverage.svg?branch=master" class="external-link"><img src="https://codecov.io/gh/julia-wrobel/registr/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://doi.org/10.21105/joss.02964" class="external-link"><img src="https://joss.theoj.org/papers/10.21105/joss.02964/status.svg" alt="DOI"></a></li>
<li><a href="https://github.com/julia-wrobel/registr/actions" class="external-link"><img src="https://github.com/julia-wrobel/registr/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Julia Wrobel, Alexander Bauer, Jeff Goldsmith, Erin McDonnell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
