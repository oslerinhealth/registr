<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registering Incomplete Curves • registr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Registering Incomplete Curves">
<meta property="og:description" content="registr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">registr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/registr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/incomplete_curves.html">Registering Incomplete Curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="incomplete_curves_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Registering Incomplete Curves</h1>
                        <h4 data-toc-skip class="author">Alexander Bauer</h4>
            
            <h4 data-toc-skip class="date">2021-05-20</h4>
      
      
      <div class="hidden name"><code>incomplete_curves.Rmd</code></div>

    </div>

    
    
<style type="text/css">
h1 { /* Header 1 */
  font-size: 26px;
}
h2 { /* Header 2 */
  font-size: 20px;
}
h3 { /* Header 3 */
  font-size: 16px;
}
</style>
<p>This vignette outlines the functionalities of the <code>registr</code> package with regard to incomplete curves.</p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>Introduction</h1>
<p>Incomplete curves arise in many applications. Incompleteness refers to functional data where (some) curves were not observed from the very beginning and/or until the very end of the common domain. Such a data structure is e.g. observed in the presence of drop-out in panel studies.</p>
<p>We differentiate three different types of (in)completeness:</p>
<ol style="list-style-type: decimal">
<li>
<strong>no incompleteness</strong>,<br>
where processes where all observed from their very beginning until their very end. In this case, it is reasonable to assume that both the starting points and the endpoints of the warping functions in the registration process lie on the diagonal since the observed process is fully comprised in the observed interval.</li>
<li>
<strong>leading incompleteness</strong>,<br>
where processes where not necessarily observed from their very beginning, but until their very end. In this case it is reasonable to assume that the endpoints lie on the diagonal since the observed process is observed until its end. The starting points of the warping functions are able to vary from the diagonal to handle potential time distortions towards the beginning of the observed domains.</li>
<li>
<strong>trailing incompleteness</strong>,<br>
where processes where observed from their very beginning, but not necessarily until their very end. In this case it is reasonable to assume that the starting points lie on the diagonal since the observed process is observed from its beginning. The endpoints of the warping functions are able to vary from the diagonal to handle potential time distortions towards the end of the observed domains.</li>
<li>
<strong>full incompleteness</strong>,<br>
where processes where neither necessarily observed from their very beginning, nor until their very end. In this case it is not reasonable to assume that either the starting points or the endpoints lie on the diagonal. The starting points and the endpoints of the warping functions are able to vary from the diagonal to handle potential time distortions both towards the beginning and the end of the observed domains.</li>
</ol>
<p>Exemplarily, we showcase the following functionalities on data from the Berkeley Growth Study (see <code><a href="../reference/growth_incomplete.html">?growth_incomplete</a></code>) where we artificially simulated that not all children were observed right from the start and that a relevant part of the children dropped out early of the study at some point in time:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">=</span> <span class="fu">registr</span><span class="fu">::</span><span class="va"><a href="../reference/growth_incomplete.html">growth_incomplete</a></span>

<span class="co"># sort the data by the amount of trailing incompleteness</span>
<span class="va">ids</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>
<span class="va">dat</span><span class="op">$</span><span class="va">id</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">id</span>, levels <span class="op">=</span> <span class="va">ids</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ids</span>, <span class="kw">function</span><span class="op">(</span><span class="va">curve_id</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">index</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">curve_id</span><span class="op">]</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># spaghetti plot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t* [observed]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Derivative"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"First derivative of growth curves"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/Berkeley%20data-1.png" width="480"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">id</span>, col <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_color_continuous</a></span><span class="op">(</span><span class="st">"Derivative"</span>, high <span class="op">=</span> <span class="st">"midnightblue"</span>, low <span class="op">=</span> <span class="st">"lightskyblue1"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t* [observed]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"curve"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"First derivative of growth curves"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/Berkeley%20data%202%20lasagna-1.png" width="480"></p>
</div>
<div id="incomplete-curve-methodology" class="section level1">
<h1 class="hasAnchor">
<a href="#incomplete-curve-methodology" class="anchor" aria-hidden="true"></a>Incomplete curve methodology</h1>
<p>We adapt the registration methodology outlined in Wrobel et al. (2019) to handle incomplete curves. Since each curve potentially has an individual range of its observed time domain, the spline basis for estimating a curve’s warping function is defined individually for each curve, based on a given number of basis functions.</p>
<p>It often is a quite strict assumption in incomplete data settings that all warping functions start and/or end on the diagonal, i.e. that the individual, observed part of the whole time domain is not (to some extent) distorted. Therefore, the <code>registr</code> package gives the additional option to estimate warping functions without the constraint that their starting point and/or endpoint lies on the diagonal.</p>
<p>On the other hand, if we fully remove such constraints, this can result in very extreme and unrealistic distortions of the time domain. This problem is further accompanied by the fact that the assessment of some given warping to be realistic or unrealistic can heavily vary between different applications. As of this reason, our method includes a penalization parameter <span class="math inline">\(\lambda\)</span> that has to be set manually to specify which kinds of distortions are deemed realistic in the application at hand.</p>
<p>Mathematically speaking, we add a penalization term to the likelihood <span class="math inline">\(\ell(i)\)</span> for curve <span class="math inline">\(i\)</span>. For a setting with <strong>full incompleteness</strong> (i.e., where both the starting point and endpoint are free to vary from the diagonal) this results in <span class="math display">\[
\begin{aligned}
\ell_{\text{pen}}(i) &amp;= \ell(i) - \lambda \cdot n_i \cdot \text{pen}(i), \\
\text{with} \ \ \ 
\text{pen}(i) &amp;= \left( \left[\hat{h}_i^{-1}(t_{max,i}^*) - \hat{h}_i^{-1}(t_{min,i}^*)\right] - \left[t_{max,i}^* - t_{min,i}^*\right] \right)^2,
\end{aligned}
\]</span> where <span class="math inline">\(t^*_{min,i},t^*_{max,i}\)</span> are the minimum / maximum of the observed time domain of curve <span class="math inline">\(i\)</span> and <span class="math inline">\(\hat{h}^{-1}_i(t^*_{min,i}), \hat{h}^{-1}_i(t^*_{max,i})\)</span> the inverse warping function evaluated at this minimum / maximum. For leading incompleteness with <span class="math inline">\(h_i^{-1}(t_{max,i}^*) = t_{max,i}^* \forall i\)</span> this simplifies to <span class="math inline">\(\text{pen}(i) = \left(\hat{h}_i^{-1}(t_{min,i}^*) - t_{min,i}^*\right)^2\)</span>, and for trailing incompleteness with <span class="math inline">\(h_i^{-1}(t_{min,i}^*) = t_{min,i}^* \forall i\)</span> to <span class="math inline">\(\text{pen}(i) = \left(\hat{h}_i^{-1}(t_{max,i}^*) - t_{max,i}^*\right)^2\)</span>. The penalization term is scaled by the number of measurements <span class="math inline">\(n_i\)</span> of curve <span class="math inline">\(i\)</span> to ensure a similar impact of the penalization for curves with different numbers of measurements.</p>
<p>The higher the penalization parameter <span class="math inline">\(\lambda\)</span>, the more the length of the registered domain is forced towards the length of the observed domain. Given a specific application, <span class="math inline">\(\lambda\)</span> should be chosen s.t. unrealistic distortions of the time domain are prevented. To do so, the user has to run the registration approach multiple times with different <span class="math inline">\(\lambda\)</span>’s to find an optimal value.</p>
</div>
<div id="application-on-incomplete-growth-data" class="section level1">
<h1 class="hasAnchor">
<a href="#application-on-incomplete-growth-data" class="anchor" aria-hidden="true"></a>Application on incomplete growth data</h1>
<p>By default, both functions <code>register_fpca</code> and <code>registr</code> include the argument <code>incompleteness = NULL</code> to constrain all warping functions to start and end on the diagonal.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg1</span> <span class="op">=</span> <span class="fu"><a href="../reference/registr.html">registr</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg1</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tstar</span>, y <span class="op">=</span> <span class="va">index</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t* [observed]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Estimated warping functions"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%201-1.png" width="480"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg1</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">id</span>, col <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_color_continuous</a></span><span class="op">(</span><span class="st">"Derivative"</span>, high <span class="op">=</span> <span class="st">"midnightblue"</span>, low <span class="op">=</span> <span class="st">"lightskyblue1"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"curve"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Registered curves"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%201%20lasagna-1.png" width="480"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg1</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Derivative"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Registered curves"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%201%20spaghetti-1.png" width="480"></p>
<p>The assumption can be dropped by setting <code>incompleteness</code> to some other value than NULL and some nonnegative value for the penalization parameter <code>lambda_inc</code>. The higher <code>lambda_inc</code> is chosen, the more the registered domains are forced to have the same length as the observed domains.</p>
<div id="small-lambda_inc" class="section level3">
<h3 class="hasAnchor">
<a href="#small-lambda_inc" class="anchor" aria-hidden="true"></a>Small <code>lambda_inc</code>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg2</span> <span class="op">=</span> <span class="fu"><a href="../reference/registr.html">registr</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>,
                             incompleteness <span class="op">=</span> <span class="st">"full"</span>, lambda_inc <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg2</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tstar</span>, y <span class="op">=</span> <span class="va">index</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t* [observed]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Estimated warping functions"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%202-1.png" width="480"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg2</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">id</span>, col <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_color_continuous</a></span><span class="op">(</span><span class="st">"Derivative"</span>, high <span class="op">=</span> <span class="st">"midnightblue"</span>, low <span class="op">=</span> <span class="st">"lightskyblue1"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"curve"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Registered curves"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%202%20lasagna-1.png" width="480"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg2</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Derivative"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Registered curves"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%202%20spaghetti-1.png" width="480"></p>
</div>
<div id="larger-lambda_inc" class="section level3">
<h3 class="hasAnchor">
<a href="#larger-lambda_inc" class="anchor" aria-hidden="true"></a>Larger <code>lambda_inc</code>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg3</span> <span class="op">=</span> <span class="fu"><a href="../reference/registr.html">registr</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>,
                             incompleteness <span class="op">=</span> <span class="st">"full"</span>, lambda_inc <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg3</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tstar</span>, y <span class="op">=</span> <span class="va">index</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t* [observed]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Estimated warping functions"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%203-1.png" width="480"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg3</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">id</span>, col <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>lwd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="external-link">scale_color_continuous</a></span><span class="op">(</span><span class="st">"Derivative"</span>, high <span class="op">=</span> <span class="st">"midnightblue"</span>, low <span class="op">=</span> <span class="st">"lightskyblue1"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"curve"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Registered curves"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid  <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
          axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%203%20lasagna-1.png" width="480"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg3</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">index</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Derivative"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Registered curves"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%203%20spaghetti-1.png" width="480"></p>
</div>
<div id="choosing-an-optimal-lambda_inc" class="section level3">
<h3 class="hasAnchor">
<a href="#choosing-an-optimal-lambda_inc" class="anchor" aria-hidden="true"></a>Choosing an optimal <code>lambda_inc</code>
</h3>
<p>As outlined, <span class="math inline">\(\lambda\)</span> should be set to the smallest value that prevents unrealistic distortions of the time domain. The intuition of what kinds of distortions are <em>unrealistic</em> has to be based on subject knowledge.</p>
<p>In the above example we see that <code>lambda_inc = 0</code> leads to extreme compressions of the time domain, which can clearly be viewed as unrealistic. These compressions can for example be prevented by setting <code>lambda_inc = 0.025</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg4</span> <span class="op">=</span> <span class="fu"><a href="../reference/registr.html">registr</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>,
                             incompleteness <span class="op">=</span> <span class="st">"full"</span>, lambda_inc <span class="op">=</span> <span class="fl">.025</span><span class="op">)</span>

<span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg4</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tstar</span>, y <span class="op">=</span> <span class="va">index</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t* [observed]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Estimated warping functions"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%204-1.png" width="480"></p>
<p>Underlying functional principal components can be estimated jointly to the registration by calling <code><a href="../reference/register_fpca.html">register_fpca()</a></code> and visualizing them with <code>registr:::plot.fpca()</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg4_joint</span> <span class="op">=</span> <span class="fu"><a href="../reference/register_fpca.html">register_fpca</a></span><span class="op">(</span>Y <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">"gaussian"</span>,
                           incompleteness <span class="op">=</span> <span class="st">"full"</span>, lambda_inc <span class="op">=</span> <span class="fl">.025</span>,
                           npc <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">reg4_joint</span><span class="op">$</span><span class="va">Y</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t_hat</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"t [registered]"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Derivative"</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Registered curves"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%204%20joint%20spaghetti-1.png" width="480"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">if</span> <span class="op">(</span><span class="va">have_ggplot2</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">reg4_joint</span><span class="op">$</span><span class="va">fpca_obj</span>, var_factor <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="incomplete_curves_files/figure-html/application%204%20joint%20FPC%20plot-1.png" width="672"></p>
</div>
</div>
<div id="constraint-matrices-for-the-optimization" class="section level1">
<h1 class="hasAnchor">
<a href="#constraint-matrices-for-the-optimization" class="anchor" aria-hidden="true"></a>Constraint matrices for the optimization</h1>
<p>Warping functions are estimated using the function <code><a href="https://rdrr.io/r/stats/constrOptim.html" class="external-link">constrOptim()</a></code>. For the estimation of the warping function for curve <span class="math inline">\(i\)</span> it uses linear inequality constraints of the form <span class="math display">\[
\boldsymbol{u}_i \cdot \boldsymbol{\beta}_i - \boldsymbol{c}_i \geq \boldsymbol{0},
\]</span> where <span class="math inline">\(\boldsymbol{\beta}_i\)</span> is the parameter vector and matrix <span class="math inline">\(\boldsymbol{u}_i\)</span> and vector <span class="math inline">\(\boldsymbol{c}_i\)</span> define the constraints.</p>
<p>For the estimation of a warping function the parameter vector is constrained s.t. the resulting warping function is monotone and does not exceed the overall time domain <span class="math inline">\([t_{min},t_{max}]\)</span>.</p>
<p>In the following the constraint matrices are listed for the different settings of (in)completeness and assuming a parameter vector of length <span class="math inline">\(p\)</span>: <span class="math display">\[
\boldsymbol{\beta}_i =
\left( \begin{array}{c}
\beta_{i1} \\ \beta_{i2} \\ \vdots \\ \beta_{ip}
\end{array} \right) \in \mathbb{R}_{p \times 1}
\]</span></p>
<p><strong>Note:</strong><br>
All following constraint matrices refer to the estimation of nonparametric inverse warping functions with <code>warping = "nonparametric"</code>.</p>
<div id="complete-curve-setting" class="section level2">
<h2 class="hasAnchor">
<a href="#complete-curve-setting" class="anchor" aria-hidden="true"></a>Complete curve setting</h2>
<p>When all curves were observed completely – i.e. the underlying processes of interest were all observed from the beginning until the end – warping functions can typically be assumed to start and end on the diagonal, since each process is completely observed in its observation interval <span class="math inline">\([t^*_{min,i},t^*_{max,i}] \subset [t_{min},t_{max}]\)</span>.</p>
<p>Assuming that both the starting point and the endpoint lie on the diagonal, we set <span class="math inline">\(\beta_{i1} = t^*_{min,i}\)</span> and <span class="math inline">\(\beta_{ip} = t^*_{max,i}\)</span> and only perform the estimation for <span class="math display">\[
\left( \begin{array}{c}
\beta_{i2} \\ \beta_{i3} \\ \vdots \\ \beta_{i(p-1)}
\end{array} \right) \in \mathbb{R}_{(p-2) \times 1}
\]</span></p>
<p>This results in the following constraint matrices, that allow a mapping from the observed domain <span class="math inline">\([t^*_{min,i},t^*_{max,i}]\)</span> to the domain itself <span class="math inline">\([t^*_{min,i},t^*_{max,i}] \subset [t_{min},t_{max}]\)</span>: <span class="math display">\[
\begin{aligned}
\boldsymbol{u}_i &amp;=
\left( \begin{array}{cccccccc}
1 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
-1 &amp; 1 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -1 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; -1 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; -1
\end{array} \right) \in \mathbb{R}_{(p-1) \times (p-2)} \\
\boldsymbol{c}_i &amp;=
\left( \begin{array}{c}
t^*_{min,i} \\ 0 \\ 0 \\ \vdots \\ 0 \\ -1 \cdot t^*_{max,i}
\end{array} \right) \in \mathbb{R}_{(p-1) \times 1}
\end{aligned}
\]</span></p>
</div>
<div id="leading-incompleteness-only" class="section level2">
<h2 class="hasAnchor">
<a href="#leading-incompleteness-only" class="anchor" aria-hidden="true"></a>Leading incompleteness only</h2>
<p>In the case of <em>leading incompleteness</em> – i.e. the underlying processes of interest were all observed until their very end but not necessarily starting from their beginning – warping functions can typically be assumed to end on the diagonal, s.t. one assumes <span class="math inline">\(\beta_{ip} = t^*_{max,i}\)</span> to let the warping functions end at the last observed time point <span class="math inline">\(t^*_{max,i}\)</span>. The estimation is then performed for the remaining parameter vector <span class="math display">\[
\left( \begin{array}{c}
\beta_{i1} \\ \beta_{i3} \\ \vdots \\ \beta_{i(p-1)}
\end{array} \right) \in \mathbb{R}_{(p-1) \times 1}
\]</span></p>
<p>This results in the following constraint matrices, that allow a mapping from the observed domain <span class="math inline">\([t^*_{min,i},t^*_{max,i}]\)</span> to the domain <span class="math inline">\([t_{min},t^*_{max,i}] \subset [t_{min},t_{max}]\)</span>: <span class="math display">\[
\begin{aligned}
\boldsymbol{u}_i &amp;=
\left( \begin{array}{cccccccc}
1 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
-1 &amp; 1 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -1 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; -1 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; -1
\end{array} \right) \in \mathbb{R}_{p \times (p-1)} \\
\boldsymbol{c}_i &amp;=
\left( \begin{array}{c}
t_{min} \\ 0 \\ 0 \\ \vdots \\ 0 \\ -1 \cdot t^*_{max,i}
\end{array} \right) \in \mathbb{R}_{p \times 1}
\end{aligned}
\]</span></p>
</div>
<div id="trailing-incompleteness-only" class="section level2">
<h2 class="hasAnchor">
<a href="#trailing-incompleteness-only" class="anchor" aria-hidden="true"></a>Trailing incompleteness only</h2>
<p>In the case of <em>trailing incompleteness</em> – i.e. the underlying processes of interest were all observed from the beginning but not necessarily until their very end – warping functions can typically be assumed to start on the diagonal, s.t. one assumes <span class="math inline">\(\beta_{i1} = t^*_{min,i}\)</span> to let the warping functions start at the first observed time point <span class="math inline">\(t^*_{min,i}\)</span>. The estimation is then performed for the remaining parameter vector <span class="math display">\[
\left( \begin{array}{c}
\beta_{i2} \\ \beta_{i3} \\ \vdots \\ \beta_{ip}
\end{array} \right) \in \mathbb{R}_{(p-1) \times 1}
\]</span></p>
<p>This results in the following constraint matrices, that allow a mapping from the observed domain <span class="math inline">\([t^*_{min,i},t^*_{max,i}]\)</span> to the domain <span class="math inline">\([t^*_{min,i},t_{max}] \subset [t_{min},t_{max}]\)</span>: <span class="math display">\[
\begin{aligned}
\boldsymbol{u}_i &amp;\text{  identical to the version for leading incompleteness} \\
\boldsymbol{c}_i &amp;=
\left( \begin{array}{c}
t^*_{min,i} \\ 0 \\ 0 \\ \vdots \\ 0 \\ -1 \cdot t_{max}
\end{array} \right) \in \mathbb{R}_{p \times 1}
\end{aligned}
\]</span></p>
</div>
<div id="leading-and-trailing-incompleteness" class="section level2">
<h2 class="hasAnchor">
<a href="#leading-and-trailing-incompleteness" class="anchor" aria-hidden="true"></a>Leading and trailing incompleteness</h2>
<p>In the case of both leading and trailing incompleteness – i.e. the underlying processes of interest were neither necessarily observed from their very beginnings nor to their very ends – warping functions can typically only be assumed to map the observed domains <span class="math inline">\([t^*_{min,i},t^*_{max,i}]\)</span> to the overall domain <span class="math inline">\([t_{min},t_{max}]\)</span>.</p>
<p>This results in the following constraint matrices: <span class="math display">\[
\begin{aligned}
\boldsymbol{u}_i &amp;=
\left( \begin{array}{cccccccc}
1 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
-1 &amp; 1 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; -1 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; 0 \\
\vdots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots &amp; \ddots \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; -1 &amp; 1 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 &amp; 0 &amp; -1
\end{array} \right) \in \mathbb{R}_{(p+1) \times p} \\
\boldsymbol{c}_i &amp;=
\left( \begin{array}{c}
t_{min} \\ 0 \\ 0 \\ \vdots \\ 0 \\ -1 \cdot t_{max}
\end{array} \right) \in \mathbb{R}_{(p+1) \times 1}
\end{aligned}
\]</span></p>
</div>
</div>
<div id="help-files" class="section level1">
<h1 class="hasAnchor">
<a href="#help-files" class="anchor" aria-hidden="true"></a>Help files</h1>
<p>Documentation for individual functions gives more information on their arguments and return objects, and can be pulled up via the following:</p>
<ul>
<li><code><a href="../reference/register_fpca.html">?register_fpca</a></code></li>
<li><code><a href="../reference/registr.html">?registr</a></code></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julia Wrobel, Alexander Bauer, Jeff Goldsmith, Erin McDonnell.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
