<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Internal function to register one curve — registr_oneCurve • registr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Internal function to register one curve — registr_oneCurve" />
<meta property="og:description" content="This internal function is only to be used from within registr.
It performs the main optimization step with constrOptim for the
registration of one curve." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">registr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/registr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/incomplete_curves.html">Registering Incomplete Curves</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Internal function to register one curve</h1>
    
    <div class="hidden name"><code>registr_oneCurve.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This internal function is only to be used from within <code>registr</code>.
It performs the main optimization step with <code>constrOptim</code> for the
registration of one curve.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>registr_oneCurve</span><span class='op'>(</span>
  obj <span class='op'>=</span> <span class='cn'>NULL</span>,
  Y <span class='op'>=</span> <span class='cn'>NULL</span>,
  Kt <span class='op'>=</span> <span class='fl'>8</span>,
  Kh <span class='op'>=</span> <span class='fl'>4</span>,
  family <span class='op'>=</span> <span class='st'>"gaussian"</span>,
  gradient <span class='op'>=</span> <span class='cn'>TRUE</span>,
  incompleteness <span class='op'>=</span> <span class='cn'>NULL</span>,
  lambda_inc <span class='op'>=</span> <span class='cn'>NULL</span>,
  beta <span class='op'>=</span> <span class='cn'>NULL</span>,
  t_min <span class='op'>=</span> <span class='cn'>NULL</span>,
  t_max <span class='op'>=</span> <span class='cn'>NULL</span>,
  periodic <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warping <span class='op'>=</span> <span class='st'>"nonparametric"</span>,
  gamma_scales <span class='op'>=</span> <span class='cn'>NULL</span>,
  global_knots <span class='op'>=</span> <span class='cn'>NULL</span>,
  mean_coefs <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>,
  verbose <span class='op'>=</span> <span class='fl'>1</span>,
  just_return_list <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>obj</th>
      <td><p>Current estimate of FPC object. 
Can be NULL only if Y argument is selected.</p></td>
    </tr>
    <tr>
      <th>Y</th>
      <td><p>Dataframe. Should have values id, value, index.</p></td>
    </tr>
    <tr>
      <th>Kt</th>
      <td><p>Number of B-spline basis functions used to estimate mean functions. Default is 8.</p></td>
    </tr>
    <tr>
      <th>Kh</th>
      <td><p>Number of B-spline basis functions used to estimate warping functions <em>h</em>. Default is 4.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>One of <code>c("gaussian","binomial","gamma","poisson")</code>. Defaults to
<code>"gaussian"</code>.</p></td>
    </tr>
    <tr>
      <th>gradient</th>
      <td><p>If <code>TRUE</code>, uses analytic gradient to calculate derivative. 
If <code>FALSE</code>, calculates gradient numerically. Not available for families
<code>"gamma","poisson"</code>.</p></td>
    </tr>
    <tr>
      <th>incompleteness</th>
      <td><p>Optional specification of incompleteness structure.
One of <code>c("leading","trailing","full")</code>, specifying that incompleteness
is present only in the initial measurements, only in the trailing measurements, or
in both, respectively. For details see the accompanying vignette.
Defaults to NULL, i.e. no incompleteness structure.
Can only be set when <code>warping = "nonparametric"</code>.</p></td>
    </tr>
    <tr>
      <th>lambda_inc</th>
      <td><p>Penalization parameter to control the amount of
overall dilation of the domain.
The higher this lambda, the more the registered domains are forced to have the
same length as the observed domains.
Only used if <code>incompleteness</code> is not NULL.</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>Current estimates for beta for each subject. Default is NULL.</p></td>
    </tr>
    <tr>
      <th>t_min</th>
      <td><p>Minimum value to be evaluated on the time domain.
if `NULL`, taken to be minimum observed value.</p></td>
    </tr>
    <tr>
      <th>t_max</th>
      <td><p>Maximum value to be evaluated on the time domain. 
if `NULL`, taken to be maximum observed value.</p></td>
    </tr>
    <tr>
      <th>periodic</th>
      <td><p>If <code>TRUE</code>, uses periodic b-spline basis functions. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>warping</th>
      <td><p>If <code>nonparametric</code> (default), inverse warping functions are estimated nonparametrically. 
If <code>piecewise_linear2</code> they follow a piecewise linear function with 2 knots.</p></td>
    </tr>
    <tr>
      <th>gamma_scales</th>
      <td><p>Only used for <code>family = "gamma"</code>.
Vector with one entry for each subject, containing the current estimate for the scale parameter of its
gamma distribution. Default is NULL, which sets the starting value for the scale parameter to 1.5.</p></td>
    </tr>
    <tr>
      <th>global_knots</th>
      <td><p>knots for the basis/splines, passed to [pbs::pbs()] 
or [stats::bs()]</p></td>
    </tr>
    <tr>
      <th>mean_coefs</th>
      <td><p>Mean coefficients for the mean of all curves or 
GFPCA based.  May extract from `obj` object</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to or from other functions</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Can be set to integers between 0 and 4 to control the level of
detail of the printed diagnostic messages. Higher numbers lead to more detailed
messages. Defaults to 1.</p></td>
    </tr>
    <tr>
      <th>just_return_list</th>
      <td><p>Do not use.  For developers only</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An list containing:</p>
<dt>hinv_innerKnots</dt><dd><p>Inner knots for setting up the spline basis
for the inverse warping function.</p></dd>
<dt>hinv_beta</dt><dd><p>Estimated B-spline basis coefficients used to construct
subject-specific inverse warping functions.</p></dd>
<dt>t_hat</dt><dd><p>Vector of registered time domain.</p></dd>
<dt>loss</dt><dd><p>Loss of the optimal solution.</p></dd>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Julia Wrobel <a href='mailto:julia.wrobel@cuanschutz.edu'>julia.wrobel@cuanschutz.edu</a>,
Erin McDonnell <a href='mailto:eim2117@cumc.columbia.edu'>eim2117@cumc.columbia.edu</a>,
Alexander Bauer <a href='mailto:alexander.bauer@stat.uni-muenchen.de'>alexander.bauer@stat.uni-muenchen.de</a></p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Julia Wrobel, Alexander Bauer, Jeff Goldsmith, Erin McDonnell.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


